---
layout: false
---

- file_regex = /\.html/
- depth = 0
- if defined? directory
	- file_regex = Regexp.new("#{directory.gsub("/","\\/")}\\/[^.]+.html")
	- depth = directory.count("/") + 1
- else
	- directory = nil

- # Naturalize a string that contains numbers
- def naturalized s
	- s.scan(/[^\d\.]+|[\d\.]+/).collect { |f| f.match(/\d+(\.\d+)?/) ? f.to_f : f }

!!! 5
%html
	%head
		%meta{ :charset => "utf-8" }/
		%title Slides
		= stylesheet_link_tag "global.css", :media => "all", :rel => "stylesheet"
	
	%body
		#content
			%h1 
				Slides
				- if !directory.nil?
					= "/#{directory}"
			:markdown

			
				This is [Andrew Pilsch](http://atp1.us)'s slide repository. It hosts slides made using both [Remark.js](http://remarkjs.com) and [Reveal.js](http://lab.hakim.se/reveal-js/).
		
			%ul
				- sitemap.resources.select{|a| (a.destination_path =~ file_regex)}.sort{|a,b| naturalized(a.destination_path.to_s) <=> naturalized(b.destination_path.to_s)}.each do |resource|
					- next if resource.data["hidden"] and resource.data["hidden"] == true
					- # Skip the template file
					- next if resource.source_file =~ /remark_markdown_template.html.haml/
					- if resource.data["title"] and resource.destination_path.count("/") <= depth
						-if resource.data["title"] == "Default Slide Title"
						%li
							= link_to "#{resource.data["title"]}", resource.destination_path.gsub("#{directory}/","")
							%small
								(#{resource.data["layout"] ? resource.data["layout"].capitalize : "Remark"})
					- if resource.destination_path =~ /.+\/index.html/ and resource.destination_path != "#{directory}/index.html" and resource.destination_path.count("/") - 1 == depth
						%li
							= if directory.nil? then link_to resource.destination_path.gsub('index.html',""), resource.destination_path.gsub('index.html',"") else link_to "#{File.basename resource.destination_path.gsub('index.html',"")}/", resource.destination_path.sub(directory + "/","") end
				