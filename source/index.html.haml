---
layout: false
---

- depth = 1
- path_hunt = "" # This is analogous to the base directory (relative to source/) where slides are stored.
- if defined? directory
	- path_hunt += "/#{directory}"
	- depth += path_hunt.count("/")
- else
	- directory = nil
- file_regex = Regexp.new("#{path_hunt.gsub("/","\\/")}\\/[^.]+.html")

- # Naturalize a string that contains numbers
- def naturalized s
	- s.scan(/[^\d\.]+|[\d\.]+/).collect { |f| f.match(/\d+(\.\d+)?/) ? f.to_f : f }

!!! 5
%html
	%head
		%meta{ :charset => "utf-8" }/
		%title Slides
		= stylesheet_link_tag "global.css", :media => "all", :rel => "stylesheet"
	
	%body
		#content
			%h1 
				Slides
				- if !directory.nil?
					= "/#{directory}"
			:markdown

			
				This is [Andrew Pilsch](http://atp1.us)'s slide repository. It hosts slides made using both [Remark.js](http://remarkjs.com) and [Reveal.js](http://lab.hakim.se/reveal-js/).
		
			%ul
				- sitemap.resources.select{|a| (a.destination_path =~ file_regex)}.sort{|a,b| naturalized(a.destination_path.to_s) <=> naturalized(b.destination_path.to_s)}.each do |resource|
					- next if resource.data["hidden"] and resource.data["hidden"] == true
					- # Skip the template file
					- next if resource.source_file =~ /remark_markdown_template.html.haml/
					- if resource.data["title"] and resource.destination_path.count("/") <= depth
						%li
							= link_to "#{resource.data["title"]}",  resource.destination_path.gsub(path_hunt + "/", "")
							%small (Remark)
					- if resource.destination_path =~ /.+\/index.html/ and resource.destination_path != "#{directory}/index.html" and resource.destination_path.count("/") - 1 == depth
						%li
							= link_to resource.destination_path.gsub(path_hunt + "/", "").gsub("index.html","").capitalize, resource.destination_path.gsub(path_hunt + "/", "")
				